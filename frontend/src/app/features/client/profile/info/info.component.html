<div class="p-6 md:p-8 h-full overflow-y-auto max-h-[800px]">
  <!-- Avatar Manager -->
  <div class="mb-8 pb-8 border-b border-gray-100">
    <h3 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-6">
      {{ "Ảnh đại diện" | translate }}
    </h3>
    <input
      #fileInput
      type="file"
      class="hidden"
      accept="image/png, image/jpeg"
      (change)="onFileSelected($event)"
    />
    <div class="flex flex-col sm:flex-row items-center gap-8">
      <!-- Show avatar -->
      <div
        class="relative shrink-0 group cursor-pointer"
        (click)="fileInput.click()"
      >
        <div
          class="w-32 h-32 rounded-full overflow-hidden border-[4px] border-white shadow-lg bg-gray-100 ring-1 ring-gray-200 relative"
        >
          @if (avatarPreview) {
            <img
              [src]="avatarPreview || 'https://i.pravatar.cc/300?img=12'"
              class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
              alt="Avatar"
            />
          } @else {
            <div
              class="w-full h-full flex items-center justify-center text-gray-300 bg-gray-50"
            >
              <nz-icon nzType="user" class="text-5xl" />
            </div>
          }

          <!-- Overlay icon Camera -->
          <div
            class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col items-center justify-center"
          >
            <nz-icon nzType="camera" class="text-white! text-2xl mb-1" />
            <span
              class="text-white text-[10px] font-bold uppercase tracking-wider"
            >
              {{ "Đổi ảnh" | translate }}
            </span>
          </div>
        </div>

        <!-- Badge -->
        <div class="absolute -bottom-2 right-5 z-10 pointer-events-none">
          <nz-tag
            [nzColor]="'geekblue'"
            class="m-0 rounded-full px-3 py-1 font-bold text-xs border-2 border-white shadow-md"
          >
            <nz-icon nzType="star" nzTheme="fill" class="mr-1" />
            {{ user().role }}
          </nz-tag>
        </div>
      </div>

      <div class="flex-1 text-center sm:text-left">
        <div class="flex flex-col sm:flex-row items-center gap-3 mb-3">
          <!-- Cancel button -->
          @if (selectedFile) {
            <button
              nz-button
              type="button"
              nzType="text"
              nzDanger
              (click)="resetAvatar(fileInput)"
              class="h-10 rounded-lg font-medium flex items-center gap-2"
            >
              <nz-icon nzType="undo" />
              {{ "Hủy" | translate }}
            </button>
          }
        </div>

        <!-- Notify status -->
        <div class="min-h-[24px]">
          @if (selectedFile) {
            <p
              class="text-sm text-blue-600 font-semibold animate-pulse flex items-center justify-center sm:justify-start gap-2 bg-blue-50 py-1 px-3 rounded-lg w-fit"
            >
              <nz-icon nzType="info-circle" nzTheme="fill" />
              {{ 'Ảnh chưa lưu.Bấm "Lưu thay đổi" bên dưới.' | translate }}
            </p>
          } @else {
            <div class="text-xs text-gray-500 space-y-1">
              <p>{{ "• Hỗ trợ: JPG, PNG." | translate }}</p>
              <p>{{ "• Tối đa: 2MB." | translate }}</p>
            </div>
          }
        </div>
      </div>
    </div>
  </div>

  <!--  Form Information  -->
  <form
    nz-form
    [formGroup]="profileForm"
    (ngSubmit)="submitProfile()"
    nzLayout="vertical"
  >
    <div class="mb-6">
      <h3 class="text-sm font-bold text-gray-500 uppercase tracking-wider mb-4">
        {{ "Thông tin cơ bản" | translate }}
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
        <nz-form-item>
          <nz-form-label nzRequired class="font-semibold text-gray-700"
            >{{ "Họ và tên" | translate }}
          </nz-form-label>
          <nz-form-control [nzErrorTip]="'Vui lòng nhập họ tên' | translate">
            <input
              nz-input
              formControlName="username"
              class="h-11 rounded-lg px-4 border-gray-200"
              [placeholder]="'Ví dụ: Nguyễn Văn A' | translate"
            />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label nzRequired class="font-semibold text-gray-700"
            >{{ "Số điện thoại" | translate }}
          </nz-form-label>
          <nz-form-control
            [nzErrorTip]="'Vui lòng nhập số điện thoại' | translate"
          >
            <input
              nz-input
              formControlName="phone"
              class="h-11 rounded-lg px-4 border-gray-200"
              placeholder="09xxxxxxxx"
            />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item class="md:col-span-2">
          <nz-form-label class="font-semibold text-gray-700"
            >{{ "Email" | translate }}
          </nz-form-label>
          <nz-form-control>
            <div class="relative group">
              <input
                nz-input
                formControlName="email"
                class="h-11 rounded-lg pl-10 bg-gray-50 text-gray-500 cursor-not-allowed border-gray-200"
              />
              <div class="absolute right-3 top-1/2 -translate-y-1/2">
                <nz-icon
                  nzType="lock"
                  class="text-gray-400"
                  nz-tooltip
                  [nzTooltipTitle]="'Không thể thay đổi' | translate"
                />
              </div>
            </div>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item class="md:col-span-2">
          <nz-form-label class="font-semibold text-gray-700"
            >{{ "Địa chỉ" | translate }}
          </nz-form-label>
          <nz-form-control>
            <textarea
              nz-input
              formControlName="address"
              rows="3"
              class="rounded-lg p-3 border-gray-200 text-base"
              [placeholder]="'Nhập địa chỉ giao hàng...' | translate"
            ></textarea>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <!--  Action bar    -->
    <div
      class="flex items-center justify-end gap-4 pt-6 border-t border-gray-100"
    >
      <button
        nz-button
        nzType="primary"
        nzSize="large"
        class="px-8 rounded-lg font-bold shadow-lg shadow-blue-200 hover:shadow-blue-300 transition-all"
        [nzLoading]="isSaving"
      >
        {{ "Lưu thay đổi" | translate }}
      </button>
    </div>
  </form>
</div>
